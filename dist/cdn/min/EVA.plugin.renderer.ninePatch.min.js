var e,t;e=this,t=function(e,t,r,i){"use strict";function o(e,t,r,i){var o,n=arguments.length,h=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(h=(n<3?o(h):n>3?o(t,r,h):o(t,r))||h);return n>3&&h&&Object.defineProperty(t,r,h),h}function n(e,t,r,i){return new(r||(r=Promise))((function(o,n){function h(e){try{a(i.next(e))}catch(e){n(e)}}function s(e){try{a(i.throw(e))}catch(e){n(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(h,s)}a((i=i.apply(e,t||[])).next())}))}class h extends t.Component{constructor(){super(...arguments),this.resource="",this.spriteName="",this.leftWidth=0,this.topHeight=0,this.rightWidth=0,this.bottomHeight=0}init(e){this.resource=e.resource,this.spriteName=e.spriteName,this.leftWidth=e.leftWidth,this.topHeight=e.topHeight,this.rightWidth=e.rightWidth,this.bottomHeight=e.bottomHeight}}h.componentName="NinePatch",o([t.decorators.IDEProp],h.prototype,"resource",void 0),o([t.decorators.IDEProp],h.prototype,"spriteName",void 0),o([t.decorators.IDEProp],h.prototype,"leftWidth",void 0),o([t.decorators.IDEProp],h.prototype,"topHeight",void 0),o([t.decorators.IDEProp],h.prototype,"rightWidth",void 0),o([t.decorators.IDEProp],h.prototype,"bottomHeight",void 0);let s=class extends r.Renderer{constructor(){super(...arguments),this.name="NinePatch",this.ninePatch={}}init(){this.renderSystem=this.game.getSystem(r.RendererSystem),this.renderSystem.rendererManager.register(this)}rendererUpdate(e){const{width:t,height:r}=e.transform.size;this.ninePatch[e.id]&&(this.ninePatch[e.id].width=t,this.ninePatch[e.id].height=r)}componentChanged(e){return n(this,void 0,void 0,(function*(){"NinePatch"===e.componentName&&(e.type===t.OBSERVER_TYPE.ADD?this.add(e):e.type===t.OBSERVER_TYPE.REMOVE?this.remove(e):(this.remove(e),this.add(e)))}))}add(e){return n(this,void 0,void 0,(function*(){const r=e.component,{type:o,data:n}=yield t.resource.getResource(r.resource);if(!n)throw new Error(`GameObject:${e.gameObject.name}'s NinePatch resource load error`);let h;h=o===t.RESOURCE_TYPE.SPRITE?r.resource+"_s|r|c_"+r.spriteName:n.image;const{leftWidth:s,topHeight:a,rightWidth:d,bottomHeight:c}=r,p=new i.NinePatch(h,s,a,d,c);this.ninePatch[e.gameObject.id]=p,r.ninePatch=p,this.containerManager.getContainer(e.gameObject.id).addChildAt(p,0)}))}remove(e){const t=this.ninePatch[e.gameObject.id];t&&(this.containerManager.getContainer(e.gameObject.id).removeChild(t),delete this.ninePatch[e.gameObject.id],t.destroy(!0))}};s.systemName="NinePatch",s=o([t.decorators.componentObserver({NinePatch:["resource","spriteName","leftWidth","topHeight","rightWidth","bottomHeight"]})],s);var a=s;e.NinePatch=h,e.NinePatchSystem=a,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@eva/eva.js"),require("@eva/plugin-renderer"),require("@eva/renderer-adapter")):"function"==typeof define&&define.amd?define(["exports","@eva/eva.js","@eva/plugin-renderer","@eva/renderer-adapter"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).EVA=e.EVA||{},e.EVA.plugin=e.EVA.plugin||{},e.EVA.plugin.renderer=e.EVA.plugin.renderer||{},e.EVA.plugin.renderer.ninePatch={}),e.EVA,e.EVA.plugin.renderer,e.EVA.rendererAdapter);
