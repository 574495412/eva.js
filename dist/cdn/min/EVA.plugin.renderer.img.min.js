var e,r;e=this,r=function(e,r,t,n,i){"use strict";function s(e,r,t,n){var i,s=arguments.length,o=s<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,r,t,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(o=(s<3?i(o):s>3?i(r,t,o):i(r,t))||o);return s>3&&o&&Object.defineProperty(r,t,o),o}function o(e,r,t,n){return new(t||(t=Promise))((function(i,s){function o(e){try{a(n.next(e))}catch(e){s(e)}}function c(e){try{a(n.throw(e))}catch(e){s(e)}}function a(e){var r;e.done?i(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(o,c)}a((n=n.apply(e,r||[])).next())}))}class c extends r.Component{constructor(){super(...arguments),this.resource=""}init(e){e&&e.resource&&(this.resource=e.resource)}}c.componentName="Img",s([r.decorators.IDEProp],c.prototype,"resource",void 0),r.resource.registerInstance(r.RESOURCE_TYPE.IMAGE,(({data:e={}})=>{const{image:r}=e;if(r)return i.Texture.from(r)})),r.resource.registerDestroy(r.RESOURCE_TYPE.IMAGE,(({instance:e})=>{e&&e.destroy(!0)}));let a=class extends t.Renderer{constructor(){super(...arguments),this.name="Img",this.imgs={}}init(){this.renderSystem=this.game.getSystem(t.RendererSystem),this.renderSystem.rendererManager.register(this)}rendererUpdate(e){const{width:r,height:t}=e.transform.size;this.imgs[e.id]&&(this.imgs[e.id].sprite.width=r,this.imgs[e.id].sprite.height=t)}componentChanged(e){return o(this,void 0,void 0,(function*(){if("Img"===e.componentName){const t=e.component;if(e.type===r.OBSERVER_TYPE.ADD){const i=new n.Sprite(null);r.resource.getResource(t.resource).then((({instance:r})=>{r||console.error(`GameObject:${e.gameObject.name}'s Img resource load error`),i.image=r})),this.imgs[e.gameObject.id]=i,this.containerManager.getContainer(e.gameObject.id).addChildAt(i.sprite,0)}else if(e.type===r.OBSERVER_TYPE.CHANGE){const{instance:n}=yield r.resource.getResource(t.resource);n||console.error(`GameObject:${e.gameObject.name}'s Img resource load error`),this.imgs[e.gameObject.id].image=n}else if(e.type===r.OBSERVER_TYPE.REMOVE){const r=this.imgs[e.gameObject.id];this.containerManager.getContainer(e.gameObject.id).removeChild(r.sprite),delete this.imgs[e.gameObject.id]}}}))}};a.systemName="Img",a=s([r.decorators.componentObserver({Img:[{prop:["resource"],deep:!1}]})],a);var d=a;e.Img=c,e.ImgSystem=d,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@eva/eva.js"),require("@eva/plugin-renderer"),require("@eva/renderer-adapter"),require("pixi.js")):"function"==typeof define&&define.amd?define(["exports","@eva/eva.js","@eva/plugin-renderer","@eva/renderer-adapter","pixi.js"],r):r(((e="undefined"!=typeof globalThis?globalThis:e||self).EVA=e.EVA||{},e.EVA.plugin=e.EVA.plugin||{},e.EVA.plugin.renderer=e.EVA.plugin.renderer||{},e.EVA.plugin.renderer.img={}),e.EVA,e.EVA.plugin.renderer,e.EVA.rendererAdapter,e.PIXI);
